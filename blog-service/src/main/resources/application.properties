# Application Name
spring.application.name=backend
spring.jpa.open-in-view=false
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:appdb}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:password}
spring.jpa.hibernate.ddl-auto=${DDL_AUTO:update}
spring.jpa.show-sql=true

# Lazy initialization - allows startup without DB/Redis
spring.main.lazy-initialization=${LAZY_INIT:false}
spring.jpa.defer-datasource-initialization=true
spring.sql.init.mode=${SQL_INIT_MODE:embedded}
spring.datasource.hikari.initialization-fail-timeout=-1

# Cache - can be disabled for standalone mode
spring.cache.type=${CACHE_TYPE:redis}

# JWT Configuration (must match auth-service)
jwt.secret=${JWT_SECRET:NTZhNDcyZTVkNDJhNDc2OTJkNzA3MjY4NzE1NjZkNDk0ZWIyNTQxNzYxNDc0NTZjNzA3MjY4NzE1NjZkNDk1OA==}

app.default-page-size=10
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:20}
spring.datasource.hikari.minimum-idle=${DB_MIN_IDLE:5}
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s
server.tomcat.connection-timeout=20000
server.tomcat.threads.max=100
server.tomcat.threads.min-spare=10
spring.mvc.async.request-timeout=10000
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when_authorized
management.endpoint.health.probes.enabled=true
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true
# CORS Configuration
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:8080}

# Rate Limiting
rate.limit.api=${RATE_LIMIT_API:100}
rate.limit.api.window=${RATE_LIMIT_API_WINDOW:60}
spring.redis.host=${SPRING_REDIS_HOST:localhost}
spring.redis.port=${SPRING_REDIS_PORT:6379}
spring.redis.password=${SPRING_REDIS_PASSWORD:}
spring.redis.timeout=${SPRING_REDIS_TIMEOUT:60000ms}
spring.redis.database=0
spring.redis.jedis.pool.max-active=${SPRING_REDIS_JEDIS_POOL_MAX_ACTIVE:8}
spring.redis.jedis.pool.max-idle=${SPRING_REDIS_JEDIS_POOL_MAX_IDLE:8}
spring.redis.jedis.pool.min-idle=${SPRING_REDIS_JEDIS_POOL_MIN_IDLE:0}
spring.redis.jedis.pool.max-wait=-1ms
spring.cache.redis.time-to-live=3600000
spring.jpa.open-in-view=false

cors.allowed-origins=http://localhost:3000,http://localhost:8080
